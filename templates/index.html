<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Barbearia PDV</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="{{ url_for('static', filename='script.js') }}" defer></script>
</head>
<body>

<div class="bg"></div>

<!-- SIDEBAR -->
<div class="sidebar">
  <div class="logo">ğŸ’ˆ</div>
  <button onclick="showPage('dashboard')">ğŸ“Š</button>
  <button onclick="showPage('pdv')">ğŸ’³</button>
  <button onclick="showPage('clientes')">ğŸ‘¤</button>
  <button onclick="showPage('servicos')">âœ‚ï¸</button>
  <button onclick="showPage('produtos')">ğŸ§´</button>
  <button onclick="showPage('planos')">ğŸ“¦</button>
  <button onclick="showPage('agenda')">ğŸ“…</button>
  <button onclick="showPage('relatorio')">ğŸ“‘</button>
</div>

<div class="content">

<!-- ================= DASHBOARD ================= -->
<div id="dashboard" class="page">
<h1>Dashboard</h1>

<div class="cards">
  <div class="card">
    <h3>ğŸ’° Faturamento do mÃªs</h3>
    <p>R$ {{ "%.2f"|format(total_mes) }}</p>
  </div>

  <div class="card">
    <h3>ğŸ’µ Dinheiro</h3>
    <p>R$ {{ "%.2f"|format(total_dinheiro) }}</p>
  </div>

  <div class="card">
    <h3>ğŸ“² Pix</h3>
    <p>R$ {{ "%.2f"|format(total_pix) }}</p>
  </div>

  <div class="card">
    <h3>ğŸ’³ CartÃ£o</h3>
    <p>R$ {{ "%.2f"|format(total_cartao) }}</p>
  </div>

  <div class="card">
    <h3>ğŸ‘¥ Clientes</h3>
    <p>{{ clientes|length }}</p>
  </div>

  <div class="card">
    <h3>ğŸ“… Agendamentos</h3>
    <p>{{ agenda|length }}</p>
  </div>

  <div class="card">
    <h3>ğŸª Caixa</h3>
    <p>
      {% if aberto %}
        <span class="aberto">Aberto</span>
      {% else %}
        <span class="fechado">Fechado</span>
      {% endif %}
    </p>
  </div>
</div>

<div class="atalhos">
  <button onclick="showPage('pdv')">ğŸ’³ Ir para PDV</button>
  <button onclick="showPage('agenda')">ğŸ“… Ver Agenda</button>
  <button onclick="showPage('clientes')">ğŸ‘¤ Clientes</button>
</div>
</div>

<!-- ================= PDV ================= -->
<div id="pdv" class="page hidden">
<h1>PDV</h1>

{% if not aberto %}
<form method="POST" action="/abrir_caixa" class="box">
  <input name="saldo" placeholder="Saldo inicial">
  <button>Abrir Caixa</button>
</form>
{% else %}
<a href="/fechar_caixa" class="btn-danger">Fechar Caixa</a>
{% endif %}

<form method="POST" action="/venda" class="box">
  <select name="tipo" id="tipo" onchange="carregarItens()" required>
    <option value="">Tipo</option>
    <option value="servico">ServiÃ§o</option>
    <option value="produto">Produto</option>
  </select>

  <select name="item" id="item" onchange="buscarPreco()" required>
    <option value="">Selecione</option>
  </select>

  <input id="valor" placeholder="Valor" disabled>

  <select name="pagamento" id="pagamento" onchange="calcularTroco()">
    <option>Dinheiro</option>
    <option>Pix</option>
    <option>CartÃ£o</option>
  </select>

  <input id="recebido" placeholder="Recebido" onkeyup="calcularTroco()">
  <p id="troco"></p>

  <button>Finalizar Venda</button>
</form>
</div>

<!-- ================= CLIENTES ================= -->
<div id="clientes" class="page hidden">
<h1>Clientes</h1>
<form method="POST" action="/add_cliente" class="box">
  <input name="nome" placeholder="Nome" required>
  <input name="telefone" placeholder="Telefone">
  <button>Salvar</button>
</form>

<ul class="lista">
{% for c in clientes %}
<li>{{ c[1] }} - {{ c[2] }}</li>
{% endfor %}
</ul>
</div>

<!-- ================= SERVIÃ‡OS ================= -->
<div id="servicos" class="page hidden">
<h1>ServiÃ§os</h1>
<form method="POST" action="/add_servico" class="box">
  <input name="nome" placeholder="ServiÃ§o" required>
  <input name="preco" placeholder="PreÃ§o" required>
  <button>Salvar</button>
</form>

<ul class="lista">
{% for s in servicos %}
<li>{{ s[1] }} - R$ {{ "%.2f"|format(s[2]) }}</li>
{% endfor %}
</ul>
</div>

<!-- ================= PRODUTOS ================= -->
<div id="produtos" class="page hidden">
<h1>Produtos</h1>
<form method="POST" action="/add_produto" class="box">
  <input name="nome" placeholder="Produto" required>
  <input name="preco" placeholder="PreÃ§o" required>
  <button>Salvar</button>
</form>

<ul class="lista">
{% for p in produtos %}
<li>{{ p[1] }} - R$ {{ "%.2f"|format(p[2]) }}</li>
{% endfor %}
</ul>
</div>

<!-- ================= PLANOS ================= -->
<div id="planos" class="page hidden">
<h1>Planos</h1>

<!-- CRIAR PLANO -->
<form method="POST" action="/add_plano" class="box">
  <input name="nome" placeholder="Nome do plano" required>
  <input name="valor" placeholder="Valor mensal" required>
  <input name="limite" placeholder="Quantidade de usos">
  <button>Criar Plano</button>
</form>

<!-- ATIVAR PLANO -->
<h3>Ativar plano</h3>
<form method="POST" action="/ativar_plano" class="box">
  <select name="cliente" required>
    {% for c in clientes %}
    <option value="{{ c[0] }}">{{ c[1] }}</option>
    {% endfor %}
  </select>

  <select name="plano" required>
    {% for p in planos %}
    <option value="{{ p[0] }}">{{ p[1] }}</option>
    {% endfor %}
  </select>

  <select name="pagamento">
    <option>Dinheiro</option>
    <option>Pix</option>
    <option>CartÃ£o</option>
  </select>

  <button>Ativar Plano</button>
</form>

<!-- USAR PLANO -->
<h3>Usar plano</h3>
<form method="POST" action="/usar_plano" class="box">
  <select name="cliente" required>
    {% for c in clientes %}
    <option value="{{ c[0] }}">
      {{ c[1] }} (Saldo: {{ c[4] }})
    </option>
    {% endfor %}
  </select>

  <select name="servico" required>
    {% for s in servicos %}
    <option value="{{ s[0] }}">{{ s[1] }}</option>
    {% endfor %}
  </select>

  <button>Usar Plano</button>
</form>
</div>


<!-- ================= AGENDA ================= -->
<div id="agenda" class="page hidden">
<h1>Agenda</h1>

<form method="POST" action="/add_agenda" class="box">
  <input type="date" name="data" required>
  <input type="time" name="hora" required>

  <select name="cliente" required>
    {% for c in clientes %}
    <option value="{{c[0]}}">{{c[1]}}</option>
    {% endfor %}
  </select>

  <select name="servico" required>
    {% for s in servicos %}
    <option value="{{s[0]}}">{{s[1]}}</option>
    {% endfor %}
  </select>

  <button>Agendar</button>
</form>

<ul class="lista">
{% for a in agenda %}
<li>
  {{ a[1] }} {{ a[2] }} â€” {{ a[3] }} ({{ a[4] }})
  <a href="/del_agenda/{{ a[0] }}" class="btn-danger">âœ–</a>
</li>
{% endfor %}
</ul>
</div>

<!-- ================= RELATÃ“RIO ================= -->
<div id="relatorio" class="page hidden">
<h1>RelatÃ³rio Mensal</h1>
<p>ğŸ’µ Dinheiro: R$ {{ "%.2f"|format(total_dinheiro) }}</p>
<p>ğŸ“² Pix: R$ {{ "%.2f"|format(total_pix) }}</p>
<p>ğŸ’³ CartÃ£o: R$ {{ "%.2f"|format(total_cartao) }}</p>
<h2>Total: R$ {{ "%.2f"|format(total_mes) }}</h2>
<a href="/relatorio_pdf" target="_blank" class="btn">ğŸ“„ PDF</a>
</div>

</div>

</body>
</html>
